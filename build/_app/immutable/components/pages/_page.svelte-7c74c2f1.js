import{S as gt,i as wt,s as bt,k as o,a as B,q as p,H as vt,l as s,m as i,h as r,c as M,r as u,n as a,I as We,p as yt,F as e,b as xe,J as ct,K as ce,L as _t,M as Et,A as dt,N as It,o as Dt,z as Ct,O as xt,P as Ye}from"../../chunks/index-c0a82f06.js";const{document:ye,window:ht}=xt;function At(h){let N,d,A,D,J,C,P,m,L,j,G,S,c,v,U,f,T,g,re,k,de,Q,he,H,fe,X,z,F,R,pe,oe,se,b,V,t,n,l,y,_,E,x,ue,K,O,_e,Z,Ae,Pe,$,Se,Te,me,Le,je,W,ke,ee,Be,Me,te,Ne,Re,ge,Ve,Oe,Y,qe,ae,Fe,Ue,ne,He,ze,Ge;return{c(){N=o("link"),d=o("script"),D=o("script"),C=o("script"),m=B(),L=o("div"),j=o("canvas"),S=B(),c=o("div"),v=o("div"),U=B(),f=o("div"),T=o("div"),g=o("input"),re=B(),k=o("button"),de=p("diffuse the f rest"),he=B(),H=o("p"),fe=p("pro tip: upload img by pasting OR dropping on the canvas"),X=B(),z=o("div"),F=o("label"),R=o("input"),pe=p(`
					upload img`),se=B(),b=o("article"),V=o("div"),t=o("p"),n=p("Model by "),l=o("a"),y=p("CompVis"),_=p(" and "),E=o("a"),x=p("Stability AI"),ue=p(" - Demo by \u{1F917} Hugging Face"),K=B(),O=o("p"),_e=p("Powered by "),Z=o("a"),Ae=p("\u{1F917} Diffusers: State-of-the-art diffusion models for image and audio generation in PyTorch"),Pe=p(". Based on "),$=o("a"),Se=p("notebook by @psuraj28"),Te=B(),me=o("h3"),Le=p("LICENSE"),je=B(),W=o("p"),ke=p("The model is licensed with a "),ee=o("a"),Be=p("CreativeML Open RAIL-M"),Me=p(" license. The authors claim no rights on the outputs you generate, you are free to use them and are accountable for their use which must not go against the provisions set in this license. The license forbids you from sharing any content that violates any laws, produce any harm to a person, disseminate any personal information that would be meant for harm, spread misinformation and target vulnerable groups. For the full list of restrictions please "),te=o("a"),Ne=p("read the license"),Re=B(),ge=o("h3"),Ve=p("Biases and content acknowledgment"),Oe=B(),Y=o("p"),qe=p("Despite how impressive being able to turn text into image is, beware to the fact that this model may output content that reinforces or exacerbates societal biases, as well as realistic faces, pornography and violence. The model was trained on the "),ae=o("a"),Fe=p("LAION-5B dataset"),Ue=p(", which scraped non-curated image-text-pairs from the internet (the exception being the removal of illegal content) and is meant for research purposes. You can read more in the "),ne=o("a"),He=p("model card"),this.h()},l(w){const I=vt('[data-svelte="svelte-bw39ln"]',ye.head);N=s(I,"LINK",{href:!0,rel:!0}),d=s(I,"SCRIPT",{src:!0});var pt=i(d);pt.forEach(r),D=s(I,"SCRIPT",{src:!0});var ut=i(D);ut.forEach(r),C=s(I,"SCRIPT",{src:!0});var mt=i(C);mt.forEach(r),I.forEach(r),m=M(w),L=s(w,"DIV",{class:!0});var Ee=i(L);j=s(Ee,"CANVAS",{class:!0}),i(j).forEach(r),S=M(Ee),c=s(Ee,"DIV",{class:!0});var Ie=i(c);v=s(Ie,"DIV",{id:!0}),i(v).forEach(r),U=M(Ie),f=s(Ie,"DIV",{});var ie=i(f);T=s(ie,"DIV",{class:!0});var De=i(T);g=s(De,"INPUT",{type:!0,class:!0,placeholder:!0}),re=M(De),k=s(De,"BUTTON",{class:!0});var Qe=i(k);de=u(Qe,"diffuse the f rest"),Qe.forEach(r),De.forEach(r),he=M(ie),H=s(ie,"P",{class:!0});var Xe=i(H);fe=u(Xe,"pro tip: upload img by pasting OR dropping on the canvas"),Xe.forEach(r),X=M(ie),z=s(ie,"DIV",{class:!0});var Ze=i(z);F=s(Ze,"LABEL",{class:!0});var Ke=i(F);R=s(Ke,"INPUT",{accept:!0,style:!0,type:!0}),pe=u(Ke,`
					upload img`),Ke.forEach(r),Ze.forEach(r),ie.forEach(r),Ie.forEach(r),Ee.forEach(r),se=M(w),b=s(w,"ARTICLE",{class:!0});var q=i(b);V=s(q,"DIV",{class:!0});var Ce=i(V);t=s(Ce,"P",{});var le=i(t);n=u(le,"Model by "),l=s(le,"A",{href:!0,rel:!0});var $e=i(l);y=u($e,"CompVis"),$e.forEach(r),_=u(le," and "),E=s(le,"A",{href:!0,rel:!0});var et=i(E);x=u(et,"Stability AI"),et.forEach(r),ue=u(le," - Demo by \u{1F917} Hugging Face"),le.forEach(r),K=M(Ce),O=s(Ce,"P",{});var we=i(O);_e=u(we,"Powered by "),Z=s(we,"A",{href:!0,rel:!0});var tt=i(Z);Ae=u(tt,"\u{1F917} Diffusers: State-of-the-art diffusion models for image and audio generation in PyTorch"),tt.forEach(r),Pe=u(we,". Based on "),$=s(we,"A",{href:!0,rel:!0});var at=i($);Se=u(at,"notebook by @psuraj28"),at.forEach(r),we.forEach(r),Ce.forEach(r),Te=M(q),me=s(q,"H3",{});var nt=i(me);Le=u(nt,"LICENSE"),nt.forEach(r),je=M(q),W=s(q,"P",{});var be=i(W);ke=u(be,"The model is licensed with a "),ee=s(be,"A",{href:!0,rel:!0});var rt=i(ee);Be=u(rt,"CreativeML Open RAIL-M"),rt.forEach(r),Me=u(be," license. The authors claim no rights on the outputs you generate, you are free to use them and are accountable for their use which must not go against the provisions set in this license. The license forbids you from sharing any content that violates any laws, produce any harm to a person, disseminate any personal information that would be meant for harm, spread misinformation and target vulnerable groups. For the full list of restrictions please "),te=s(be,"A",{href:!0,rel:!0});var ot=i(te);Ne=u(ot,"read the license"),ot.forEach(r),be.forEach(r),Re=M(q),ge=s(q,"H3",{});var st=i(ge);Ve=u(st,"Biases and content acknowledgment"),st.forEach(r),Oe=M(q),Y=s(q,"P",{});var ve=i(Y);qe=u(ve,"Despite how impressive being able to turn text into image is, beware to the fact that this model may output content that reinforces or exacerbates societal biases, as well as realistic faces, pornography and violence. The model was trained on the "),ae=s(ve,"A",{href:!0,rel:!0});var it=i(ae);Fe=u(it,"LAION-5B dataset"),it.forEach(r),Ue=u(ve,", which scraped non-curated image-text-pairs from the internet (the exception being the removal of illegal content) and is meant for research purposes. You can read more in the "),ne=s(ve,"A",{href:!0,rel:!0});var lt=i(ne);He=u(lt,"model card"),lt.forEach(r),ve.forEach(r),q.forEach(r),this.h()},h(){a(N,"href","https://cdnjs.cloudflare.com/ajax/libs/drawingboard.js/0.4.2/drawingboard.css"),a(N,"rel","stylesheet"),We(d.src,A="https://code.jquery.com/jquery-1.12.4.min.js")||a(d,"src",A),We(D.src,J="https://cdnjs.cloudflare.com/ajax/libs/drawingboard.js/0.4.2/drawingboard.min.js")||a(D,"src",J),We(C.src,P="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.1/iframeResizer.contentWindow.min.js")||a(C,"src",P),a(j,"class",G="border-[1.2px] desktop:mt-[34px] "+(h[5]?"":"hidden")),a(v,"id","board-container"),a(g,"type","text"),a(g,"class","border-2 py-1"),a(g,"placeholder","Add prompt"),a(k,"class","bg-blue-500 hover:bg-blue-700 text-white font-bold py-1.5 px-4"),a(T,"class",Q="flex gap-x-2 mt-3 items-center justify-center "+(h[1]?"animate-pulse":"")),a(H,"class","no-hover:hidden mt-2 opacity-50"),a(R,"accept","image/*"),yt(R,"display","none"),a(R,"type","file"),a(F,"class","with-hover:hidden border py-1 px-1.5 bg-slate-200 cursor-pointer"),a(z,"class","mt-2"),a(c,"class",oe="flex flex-col items-center "+(h[1]?"pointer-events-none":"")),a(L,"class","flex flex-wrap gap-x-4 gap-y-2 justify-center my-8"),a(l,"href","https://huggingface.co/CompVis"),a(l,"rel","nofollow"),a(E,"href","https://huggingface.co/stabilityai"),a(E,"rel","nofollow"),a(Z,"href","https://github.com/huggingface/diffusers"),a(Z,"rel","nofollow"),a($,"href","https://twitter.com/psuraj28/status/1562039265126670339"),a($,"rel","nofollow"),a(V,"class","text-center"),a(ee,"href","https://huggingface.co/spaces/CompVis/stable-diffusion-license"),a(ee,"rel","nofollow"),a(te,"href","https://huggingface.co/spaces/CompVis/stable-diffusion-license"),a(te,"rel","nofollow"),a(ae,"href","https://laion.ai/blog/laion-5b/"),a(ae,"rel","nofollow"),a(ne,"href","https://huggingface.co/CompVis/stable-diffusion-v1-4"),a(ne,"rel","nofollow"),a(b,"class","prose-sm px-24 mb-8")},m(w,I){e(ye.head,N),e(ye.head,d),e(ye.head,D),e(ye.head,C),xe(w,m,I),xe(w,L,I),e(L,j),h[11](j),e(L,S),e(L,c),e(c,v),h[12](v),e(c,U),e(c,f),e(f,T),e(T,g),ct(g,h[0]),e(T,re),e(T,k),e(k,de),e(f,he),e(f,H),e(H,fe),e(f,X),e(f,z),e(z,F),e(F,R),h[14](R),e(F,pe),xe(w,se,I),xe(w,b,I),e(b,V),e(V,t),e(t,n),e(t,l),e(l,y),e(t,_),e(t,E),e(E,x),e(t,ue),e(V,K),e(V,O),e(O,_e),e(O,Z),e(Z,Ae),e(O,Pe),e(O,$),e($,Se),e(b,Te),e(b,me),e(me,Le),e(b,je),e(b,W),e(W,ke),e(W,ee),e(ee,Be),e(W,Me),e(W,te),e(te,Ne),e(b,Re),e(b,ge),e(ge,Ve),e(b,Oe),e(b,Y),e(Y,qe),e(Y,ae),e(ae,Fe),e(Y,Ue),e(Y,ne),e(ne,He),ze||(Ge=[ce(ht,"drop",_t(Et(h[8]))),ce(ht,"paste",h[9]),ce(g,"keydown",h[10]),ce(g,"input",h[13]),ce(k,"click",h[6]),ce(R,"change",h[7])],ze=!0)},p(w,I){I[0]&32&&G!==(G="border-[1.2px] desktop:mt-[34px] "+(w[5]?"":"hidden"))&&a(j,"class",G),I[0]&1&&g.value!==w[0]&&ct(g,w[0]),I[0]&2&&Q!==(Q="flex gap-x-2 mt-3 items-center justify-center "+(w[1]?"animate-pulse":""))&&a(T,"class",Q),I[0]&2&&oe!==(oe="flex flex-col items-center "+(w[1]?"pointer-events-none":""))&&a(c,"class",oe)},i:dt,o:dt,d(w){r(N),r(d),r(D),r(C),w&&r(m),w&&r(L),h[11](null),h[12](null),h[14](null),w&&r(se),w&&r(b),ze=!1,It(Ge)}}}const Je=500,ft=3e3;function Pt(){window.createImageBitmap=async function(h){return new Promise((N,d)=>{const A=document.createElement("canvas"),D=A.getContext("2d");A.width=h.width,A.height=h.height,D.putImageData(h,0,0);const J=A.toDataURL(),C=document.createElement("img");C.addEventListener("load",()=>{N(C)}),C.src=J})}}function St(h,N,d){let A="",D=!1,J=!1,C,P,m,L,j,G,S,c=400,v,U,f,T=!1,g=[];async function re(){if(!m)return;const t=m.createImageData(P.width,P.height),n=t.data;for(let _=0,E=n.length;_<E;_+=4)n[_]=40*Math.random()*7,n[_+1]=40*Math.random()*7,n[_+2]=40*Math.random()*7,n[_+3]=255;const l=await createImageBitmap(t),y=performance.now()-L;m.globalAlpha=Math.min(y,ft)/ft,m.drawImage(l,0,0,c,c),D&&window.requestAnimationFrame(re)}function k(t){if(!m)return;const n=performance.now()-j;m.globalAlpha=Math.min(n,Je)/Je,m.drawImage(t,0,0,c,c),n<Je&&window.requestAnimationFrame(()=>k(t))}async function de(t){const n=t.toDataURL("png"),y=await(await fetch(n)).blob(),_=new File([y],"canvas shot.png",{type:"image/png"}),E=t.getContext("2d").getImageData(0,0,c,c),x=await createImageBitmap(E);return{imgFile:_,imgBitmap:x}}async function Q(){if(!A)return alert("Please add prompt");if(!P||!m)return;d(1,D=!0),d(5,T=!1),fe(),L=performance.now(),re();const{imgFile:t,imgBitmap:n}=await de(P),l=new FormData;l.append("prompt",A),l.append("strength","0.85"),l.append("image",t);try{const y=await fetch("https://sdb.pcuenca.net/i2i",{method:"POST",body:l}),_=JSON.parse(await y.text()),{images:E}=_;if(!E.length)return alert("All the results were flagged. Please try again with diffeerent sketch + prompt");g=await Promise.all(E.map(async ue=>{const K=new Image;return K.src=`data:image/png;base64, ${ue}`,await new Promise((O,_e)=>{K.onload=()=>O(K)}),K})),d(1,D=!1),S&&clearInterval(S),d(5,T=!0);let x=0;j=performance.now(),k(g[x%g.length]),G=()=>{S&&clearInterval(S),j=performance.now(),x=x+1,k(g[x%g.length])},S=setInterval(()=>{x=x+1,j=performance.now(),k(g[x%g.length])},2500),!J&&g.length>1&&he()}catch(y){console.error(y),alert("Error happened, queue might be full. Please try again in a bit :)")}}function he(){const t=document.createElement("div");t.className="drawing-board-control";const n=document.createElement("button");n.innerHTML="\u23EF",n.onclick=G,t.append(n);const l=document.querySelector(".drawing-board-controls");l&&(l.appendChild(t),J=!0,d(2,v.onclick=()=>{S&&clearInterval(S)},v))}function H(){const t=document.createElement("div");t.className="drawing-board-control";const n=document.createElement("button");n.innerHTML="\u{1F9F9}",n.onclick=()=>{m==null||m.clearRect(0,0,c,c)},t.append(n);const l=document.querySelector(".drawing-board-controls");l&&l.appendChild(t)}function fe(){const t=f.getContext("2d");d(4,f.width=P.width,f),d(4,f.height=P.height,f),t.drawImage(P,0,0)}async function X(t){S&&clearInterval(S);const n=new Image;n.src=URL.createObjectURL(t),await new Promise((_,E)=>{n.onload=()=>_(n)});const{width:l,height:y}=n;m==null||m.drawImage(n,0,0,l,y,0,0,c,c)}function z(){var n;const t=(n=U.files)==null?void 0:n[0];t&&X(t)}function F(t){var y;if(!((y=t.dataTransfer)!=null&&y.files))return;t.preventDefault();const l=Array.from(t.dataTransfer.files)[0];X(l)}function R(t){if(!t.clipboardData)return;const n=Array.from(t.clipboardData.files);if(n.length===0)return;t.preventDefault();const l=n[0];X(l)}function pe(t){t.code==="Enter"&&(t.preventDefault(),Q())}Dt(async()=>{typeof createImageBitmap>"u"&&Pt();const{innerWidth:t}=window;c=Math.min(c,Math.floor(t*.75)),d(2,v.style.width=`${c}px`,v),d(2,v.style.height=`${c}px`,v),d(4,f.style.width=`${c}px`,f),d(4,f.style.height=`${c}px`,f),await Ct(),C=new window.DrawingBoard.Board("board-container",{size:10,controls:["Color",{Size:{type:"dropdown"}},{DrawingMode:{filler:!1}}],webStorage:!1,enlargeYourContainer:!0}),P=C.canvas,m=P.getContext("2d"),P.ondragover=function(n){return n.preventDefault(),!1},H()});function oe(t){Ye[t?"unshift":"push"](()=>{f=t,d(4,f)})}function se(t){Ye[t?"unshift":"push"](()=>{v=t,d(2,v)})}function b(){A=this.value,d(0,A)}function V(t){Ye[t?"unshift":"push"](()=>{U=t,d(3,U)})}return[A,D,v,U,f,T,Q,z,F,R,pe,oe,se,b,V]}class Lt extends gt{constructor(N){super(),wt(this,N,St,At,bt,{},null,[-1,-1])}}export{Lt as default};
